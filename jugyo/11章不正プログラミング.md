# 11章　不正プログラム
## 11.1 不正プログラムの種類
### 11.1.1 不正プログラムの構造による分類
* ウイルス  
媒体を必要とする(感染)
* ワーム  
媒体を必要としない(コピー)
* トロイの木馬  
バックドアや情報収集など  
利用者をだましてインストールさせる、最近増えている

### 11.1.2 不正プログラムの動作による分類
* スパイウェア  
秘密裏に侵入、PC上の情報を外部に送信、情報収集
* アドウェア  
強制的に広告を表示
* ボット  
PCに常駐、リモートでPCを操作できるようにする
* バックドア  
侵入を容易にするための「裏口」プログラム
* キーロガー  
キーボドからの入力を監視し記録する  
パスワードなどの機密情報を外部に送信  
暗号化対策が無効
- ランサムウェア  
データを人質にとり、脅迫をするプログラム

### 11.1.3 亜種
ウィルス対策ソフトがあるウイルスに対応したウイルス定義ファイルを  
作成しても、その亜種が発生すると別のプログラムとみなされるため、  
新たな対応が必要  
スクリプト言語は亜種が発生しやすい

### 11.1.4 ウイルス名の統一
ベンダーによって命名規則が違う

## 11.2 不正プログラムの感染経路
### 11.2.1 メールによる感染
* 機密性も完全性も確保されない  
=> 最も多いウイルス感染経路
* 疑わしいメールは「開かない」
- 標的型攻撃
- 添付ファイルによる感染
- リンクをクリックさせ不正サイトに誘導

### 11.2.2 Webからの感染
* ブラウザのセキュリティ・ホール  
=> 修正プログラム
* クライアントサイドプログラム  
=> セキュリティ設定
* 身元不明なプログラムはダウンロードしない

### 11.2.3 メディアからの感染
* USBメモリなど => 自動実行で感染　

### 11.2.4 ソフトウェアのインストールによる感染
* ダウンロードしたプログラムと別のプログラムが  
一緒にインストールされる
* ユーザ使用許諾契約書の確認重要
* グレイ(灰色)ウェア

### 11.2.4 ネットワークでの感染
* バッファオーバーフローを想定して不正パケット送信  
=> 「ネットワーク型」ウイルス
* LAN内に不用意に持ち込まれたPCからの感染  
=> 検疫VLAN
* ファイル共有  
共有フォルダによる感染
* ファイル共有ソフト
	* ファイル共有ソフト、ファイル交換ソフト、P2Pソフト
	* ユーザの秘匿性を保つ
	* 著作権侵害の問題
	* ダブルクリックによるウイルスやスパイウェアなどに感染

## 11.3 不正プログラムの活動
### 11.3.1 バックドアの作成
PCを遠隔操作するためのプログラム  
「裏口」として機能

### 11.3.2 情報発信(暴露ウイルス)
* P2Pファイル共有ソフトを利用 => Antinny
* 不正プログラムを実行させる => ファイルの偽装(二重拡張子)

### 11.3.3 メール発信
* SMTPでのメール送信機能
* 不正中継

### 11.3.4 改ざん
* Webページの改ざん
* hostsファイルの改ざん => 不正なWebへの誘導 => フィッシング詐欺
* ログファイル => 証拠を消す
* システムファイル => 不正プログラムの組み込み

### 11.3.5 外部への攻撃
* ウイルス/ワームの感染活動
* Dos攻撃
* DDos攻撃

## 11.4 検出方法
### 11.4.1 ウイルス検出方法の種類
* パターンマッチング  
	- シグニチャのデータベースとファイルを比較
	- 高精度、高速な検出
	- 未知のウイルスは検出できない
* ルールベース  
	- 動作を検査対象とした検出方法
	- 未知のウイルスや亜種の検出が可能
	- 誤検出の可能性
		* ヒューリスティック  
		実行していないプログラムファイルを検査  
		コードからプログラムの動作を分析
		* ビヘイビア(動的ヒューリスティック)  
		実行して不正な動作を行ったプログラムを検出
- ジェネリック  
亜種の特徴をシグニチャとしてデータベース化して  
検出する手法
- サンドボックス  
通常のメモリとは別の保護されたメモリ空間内で  
プログラムを実行さえる技術

### 11.4.2 ウイルスの処理方法
* 駆除  
ウイルスコードのみ除去
* 削除  
ファイルを削除
* 隔離  
ファイルを別のフォルダに隔離
