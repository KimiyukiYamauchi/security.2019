# 15章　セキュリティプロトコル
## 15.1 セキュリティプロトコル

* 暗号化
* 改ざんの検知
* なりすましの検知
* 否認の防止
* 「暗号化」、「認証」 => PKIを実装

## 15.2 代表的なセキュリティプロトコル

セキュリティプロトコル | 暗号化や認証となるおもな対象 | OSI7層モデルでの対応
--- | --- | ---
PGP | ファイル、メール | 7層
S/MIME | ↑ | 7層
SSH | トラフィック | 5～7層
TLS(SSL) | ↑ | 5～6層
IPsec | ↑ | 3層

### 15.2.1 PGP(Pretty Good Privacy)

* 共通鍵(セッション鍵) => 公開鍵で暗号化
* メールメッセージ => 共通鍵(セッション鍵)で暗号化
* ハイブリッド方式
* 公開鍵の真正性 => 利用者相互の署名 => 電子証明書必要なし
* 秘密鍵が紛失や盗難にあったしまった場合の対応に問題

### 15.2.2 S/MIME(Secure Multipurpose Internet Mail Extensions)

* 共通鍵 => 公開鍵で暗号化
* メールメッセージ => 共通鍵で暗号化
* ハイブリッド方式
* PKIを利用
* 秘密鍵が紛失や盗難にあったしまった場合はCRLを利用

### 15.2.3 SSH(Secure Shell)

* 通信経路を暗号化することで安全性を高めたリモート通信用のシェル
* 通信経路の暗号化 => 共通鍵暗号方式
* 認証 => 公開鍵暗号方式
* ポートフォワーディング機能
	* メールクライアント <-> sshクライアント(平文)
	* sshクライント <-> sshサーバ(暗号文)
	* sshサーバ <-> メールサーバ(平文)

### 15.2.4 TLS(SSL)

* アプリケーション層とは独立  
=> HTTP以外サービスでも利用可能  
https[443/tcp], smtps[465/tcp], pops[995/tcp]  
imaps[993/tcp], ftps[990/tcp]  
* SSL3.0 => TLS1.0(IETF)
* TLS/SSLによるWebデータの送受信
	1. TLSを使用した接続要求
	1. サーバ証明書(電子証明書)の送信
	1. サーバ証明書の検証
	1. セッションキー(共通鍵)の作成
	1. サーバ公開鍵でセッションキーを暗号化
	1. 鍵交換
* TLS(SSL)アクセラレータ

### 15.2.5 IPsec
* IPを使用する通信であれば全て暗号化可能
* IPsecの機能例
	* IKE => 鍵交換プロトコル
	* ESP => 「暗号化」「完全性の確保」「認証」の機能を持つプロトコル  
(盗聴の防止、改ざん、なりすましを検知)
	* AH =>「完全性の確保」「認証」の機能をもつプロトコル  
(改ざん、なりすましを検知) 
* IPv6 => IPsecの標準実装
